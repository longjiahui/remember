(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c35add66"],{"03b6":function(t,e,n){},"0da9":function(t,e,n){"use strict";var r=n("03b6"),o=n.n(r);o.a},a55b:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login"},[n("transition",{attrs:{name:"slide-fade",mode:"out-in",appear:""},on:{"after-enter":t.handleStateSwitch}},[t.passwordState?n("div",{key:"password",staticClass:"input-group"},[n("div",{staticClass:"back-username-input",on:{click:t.handleBack}},[n("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.username)+" : ")]),t._v("返回")]),n("div",{class:"input-group-content container-column"+(t.password&&t.passwordWrong?" with-error":"")},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],ref:"passwordInput",staticClass:"input input-large",attrs:{placeholder:"密码",type:"password"},domProps:{value:t.password},on:{input:[function(e){e.target.composing||(t.password=e.target.value)},t.handleInputPassword],keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleClickEnter(e)}}}),n("div",{staticClass:"button button-large btn-yes",on:{click:t.handleClickEnter}},[n("i",{staticClass:"iconfont icon-enter"})]),n("transition",{attrs:{name:"fade"}},[!t.nameExist&&t.passwordWrong?n("div",{staticClass:"input-info go-register"},[t._v("用户名长度必须为6-20个字符")]):t._e()])],1)]):n("div",{key:"username",staticClass:"input-group"},[n("h1",{staticStyle:{"margin-bottom":"20px"}},[t._v("Step1: 输入登录用户名")]),n("div",{class:"input-group-content container-column"+(!t.username||t.nameExist&&!t.usernameWrong?"":" with-error")},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],ref:"usernameInput",staticClass:"input input-large",attrs:{autofocus:"",placeholder:"用户名",type:"text"},domProps:{value:t.username},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleClickEnter(e)},input:[function(e){e.target.composing||(t.username=e.target.value)},t.handleInputUsername]}}),n("div",{staticClass:"button button-large btn-yes",on:{click:t.handleClickEnter}},[n("i",{staticClass:"iconfont icon-enter"})])]),n("transition",{attrs:{name:"fade"}},[!t.username||t.usernameWrong||t.nameExist?t._e():n("div",{staticClass:"input-info go-register",on:{click:function(e){t.passwordState=!0}}},[t._v("用户名 "),n("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.username))]),t._v(" 未注册，点击前往注册")]),t.username&&t.usernameWrong?n("div",{staticClass:"input-info go-register"},[t._v("用户名长度必须为6-20个字符")]):t._e()])],1)])],1)},o=[],s=n("b8c0"),a=n.n(s),i=new a.a({usernameType:{and:["string",function(t){return t.length>6&&t.length<20}]},passwordType:{and:["string",function(t){return t.length>6&&t.length<20}]}}),u={data:function(){return{timeoutInstance:null,passwordTimeoutInstance:null,username:"",nameExist:!0,passwordState:!1,password:"",passwordWrong:!1,usernameWrong:!1}},created:function(){var t=localStorage.getItem("username");t&&(this.username=t,this.passwordState=!0)},methods:{handleInputPassword:function(t){var e=this;this.passwordWrong=!1,this.passwordTimeoutInstance&&(clearTimeout(this.passwordTimeoutInstance),this.passwordTimeoutInstance=null),t.target.value&&(this.passwordTimeoutInstance=setTimeout((function(){e.checkPassword(t.target.value)}),1e3))},checkPassword:function(t){var e=this,n=i.validate(t,"passwordType");return n.catch((function(t){e.passwordWrong=!0})),n},handleStateSwitch:function(){this.$refs.passwordInput&&this.$refs.passwordInput.focus(),this.$refs.usernameInput&&this.$refs.usernameInput.focus()},handleBack:function(){this.passwordState=!1,this.password="",this.passwordWrong=!1,localStorage.removeItem("username")},checkUsername:function(t){var e=this;return this.timeoutInstance&&(clearTimeout(this.timeoutInstance),this.timeoutInstance=null),i.validate(t,"usernameType").then((function(){return e.$api.user.check(t).then((function(t){var n=t.exist;return e.nameExist=n,n}))})).catch((function(t){e.usernameWrong=!0}))},handleInputUsername:function(t){var e=this;this.usernameWrong=!1,this.nameExist=!0,this.timeoutInstance&&(clearTimeout(this.timeoutInstance),this.timeoutInstance=null),t.target.value&&(this.timeoutInstance=setTimeout((function(){e.checkUsername(e.username)}),1e3))},handleClickEnter:function(){var t=this;this.passwordState?this.nameExist?this.$api.user.login(this.username,this.password).then((function(e){localStorage.setItem("token",e),localStorage.setItem("username",t.username),t.$router.push("/console")})).catch((function(e){console.error(e),t.passwordWrong=!0})):(this.passwordTimeoutInstance&&(clearTimeout(this.passwordTimeoutInstance),this.passwordTimeoutInstance=null),this.checkPassword(this.password).then((function(){t.$api.user.register(t.username,t.password).then((function(e){localStorage.setItem("token",e),localStorage.setItem("username",t.username),t.$router.push("/console")})).catch((function(e){console.error(e),t.passwordWrong=!0}))}))):this.checkUsername(this.username).then((function(e){e&&(t.passwordState=!0)}))}}},c=u,l=(n("0da9"),n("2877")),f=Object(l["a"])(c,r,o,!1,null,"15da67e2",null);e["default"]=f.exports},b8c0:function(t,e,n){!function(e,n){t.exports=n()}("undefined"==typeof self||self,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=s(n(1)),o=s(n(2));function s(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e||(e={});var o={};Object.assign(o,r.default),Object.assign(o,e);var s=Object.keys(o);this._testFuncs=[],s.forEach((function(t){n.registerTestFunc(t,(function(e){return this.validate(e,o[t])}))}))}var e,n,s;return e=t,(n=[{key:"registerTestFunc",value:function(t,e){if(!t||!e)throw"args error";this._testFuncs[t.toUpperCase()]=e}},{key:"validate",value:function(t,e){var n=this;if(("string"==typeof e||e instanceof RegExp||"function"==typeof e)&&(e={".":e}),!e||"object"!==c(e))throw"args error";var r=this,o=Object.keys(e),s=[];return o.forEach((function(o){var a,u;try{var l=function(t){return new Promise((function(e,n){t.then((function(){e()})).catch((function(t){var e=t&&t.rule,s=t&&t.desc,a="error: ".concat(o,", rule: ").concat(r.dumpRule(u),", theRule: ").concat(r.dumpRule(e),", desc: ").concat(s);n({error:a,key:o,rule:u,theRule:e,_origin:t})}))}))};if(u=e[o],"..."===o){var f=function(){return l(Promise.reject({desc:"can't spread target"}))};t?t instanceof Array?t.forEach((function(e,r){s.push(l(n.testRule(e,u,i({},t,{_index:r}))))})):"object"===c(t)?Object.keys(t).forEach((function(e){s.push(l(n.testRule(t[e],u,i({},t,{_key:e}))))})):s.push(f()):s.push(f())}else{var p=o,d=!/\?$/.test(p);p=d?p:p.slice(0,p.length-1),void 0===(a=n.getVal(t,p))?d&&s.push(l(Promise.reject({desc:"path is unavailable which is nesessary"}))):s.push(l(n.testRule(a,u,t)))}}catch(t){throw"path: ".concat(o,", rule: ").concat(n.dumpRule(u),", error: ").concat(t)}})),Promise.all(s)}},{key:"dumpRule",value:function(t){if(t){if("string"==typeof t)return t;if("object"===c(t))return JSON.stringify(t,(function(t,e){return"function"==typeof e?"[Function]":e}));if("function"==typeof t)return"[Function]"}return""}},{key:"getVal",value:function(t,e){if(!e)throw"blank path";return"."===e||e.split(".").forEach((function(e){t&&"object"===c(t)&&(t=t[e])})),t}},{key:"_preHandleRule",value:function(t){var e=this,n=t;if(t instanceof RegExp)return function(e){return t.test(e)};if(t&&"object"===c(t)&&(n=(0,o.default)(!0,{},t)),"string"==typeof t){var r=!1;/\?$/.test(n)&&(r=!0,n=n.slice(0,n.length-1));var s=/^(\S+)\[(\S+)\]$/.exec(n);if(s&&3===s.length){var a=s[1],i=s[2];n=function(t){return e.validate(t,{".":a,"...":i})}}r&&(n={or:["null",n]})}if(!("object"!==c(t)||t.or instanceof Array||t.and instanceof Array)){var u=n;n=function(t){return e.validate(t,u)}}return t instanceof Array&&(n="array",t.length>0&&(1===t.length?n={"...":t[0]}:t.length>1&&(n={},t.forEach((function(t,e){n[e]=t}))),n=this._preHandleRule(n))),n}},{key:"testRule",value:function(t,e,n){var r=!0;if(!e)throw"blank rule";if("string"==typeof(e=this._preHandleRule(e))){var o=this.getTestFunc(e);if(!o)throw"can't find rule: ".concat(this.dumpRule(e));try{r=o.call(this,t,n,this)}catch(t){throw"RULE EXCEPTION: ".concat(this.dumpRule(e),", FOR: ").concat(t)}}else if("function"==typeof e)r=e.call(this,t,n,this);else if("object"===c(e)){if(e.or&&e.or instanceof Array)return this.testOrRules(t,e.or,n);if(e.and&&e.and instanceof Array)return this.testAndRules(t,e.and,n);throw"bad rule: ".concat(this.dumpRule(e))}return r instanceof Promise?r:r?Promise.resolve():Promise.reject({val:t,rule:e})}},{key:"getTestRulesPromises",value:function(t,e,n){var r=this;if(e&&e instanceof Array){var o=[];return e.forEach((function(e){var s=r.testRule(t,e,n);s&&(s instanceof Promise?o.push(s):o.push(s?Promise.resolve():Promise.reject({val:t,rule:e})))})),o}throw"blank rules"}},{key:"testAndRules",value:function(t,e,n){return Promise.all(this.getTestRulesPromises(t,e,n))}},{key:"testOrRules",value:function(t,e,n){return Promise.or(this.getTestRulesPromises(t,e,n))}},{key:"getTestFunc",value:function(t){if(t&&this._testFuncs){var e=t.toUpperCase(),n=this._testFuncs[e];if("function"==typeof(n=this._preHandleRule(n)))return n;throw"".concat(e," is not function type")}return null}}])&&l(e.prototype,n),s&&l(e,s),t}();e.default=f,Promise.or=function(t){var e=[];function n(t){return new Promise((function(e,n){t.then((function(t){n(t)})).catch((function(t){e(t)}))}))}return t&&t.length>0?(t.forEach((function(t){e.push(n(t))})),n(Promise.all(e))):Promise.resolve()}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={truthy:function(t){return!!t},truthyString:function(t){return!!t&&"string"==typeof t},falsy:function(t){return!t},object:function(t){return t&&"object"===r(t)},number:function(t){return"number"==typeof t},string:function(t){return"string"==typeof t},boolean:function(t){return"boolean"==typeof t},null:function(t){return null==t},completeNull:function(t){return null===t},completeUndefined:function(t){return void 0===t},function:function(t){return"function"==typeof t},array:function(t){return t instanceof Array},any:function(){return!0}};e.default=o},function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,i=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===o.call(t)},u=function(t){if(!t||"[object Object]"!==o.call(t))return!1;var e,n=r.call(t,"constructor"),s=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!s)return!1;for(e in t);return void 0===e||r.call(t,e)},c=function(t,e){s&&"__proto__"===e.name?s(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},l=function(t,e){if("__proto__"===e){if(!r.call(t,e))return;if(a)return a(t,e).value}return t[e]};t.exports=function t(){var e,n,r,o,s,a,f=arguments[0],p=1,d=arguments.length,h=!1;for("boolean"==typeof f&&(h=f,f=arguments[1]||{},p=2),(null==f||"object"!=typeof f&&"function"!=typeof f)&&(f={});p<d;++p)if(null!=(e=arguments[p]))for(n in e)r=l(f,n),f!==(o=l(e,n))&&(h&&o&&(u(o)||(s=i(o)))?(s?(s=!1,a=r&&i(r)?r:[]):a=r&&u(r)?r:{},c(f,{name:n,newValue:t(h,a,o)})):void 0!==o&&c(f,{name:n,newValue:o}));return f}}]).default}))}}]);